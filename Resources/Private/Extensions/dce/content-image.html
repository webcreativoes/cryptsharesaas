<f:for each="{field.image}" as="fileReference">
    <f:if condition="{field.link}">
        <f:then>
            <f:link.typolink parameter="{field.link}" target="_blank" class="ico-class" title="{f:format.htmlspecialchars(field.titletext)}">
                <f:image src="{fileReference.uid}" 
                         alt="{f:format.htmlspecialchars(field.alttext)}" 
                         treatIdAsReference="1" 
                         class="{f:if(condition: field.isthumbnail, then: 'img-thumbnail mb-3', else: 'img-fluid mx-auto d-block')}" />
            </f:link.typolink>
        </f:then>
        <f:else>
            <f:image src="{fileReference.uid}" 
                     alt="{f:format.htmlspecialchars(field.alttext)}" 
                     title="{f:format.htmlspecialchars(field.titletext)}" 
                     treatIdAsReference="1" 
                     class="{f:if(condition: field.isthumbnail, then: 'img-thumbnail mb-3', else: 'img-fluid mx-auto d-block')}" />
        </f:else>
    </f:if>
</f:for>
